---
title: "Report_10883408"
author: '10883408'
date: "2024-04-08"
output:
  pdf_document: 
   latex_engine: xelatex
  word_document: default
editor_options:
  chunk_output_type: console
---


```{r loadlib, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(caret)
library(randomForest)
library(ggplot2)
library(dplyr)
library(e1071)
library(rpart)
library(rpart.plot)
library(RColorBrewer)
```

## ML part A 
```{r part A, echo=FALSE}

earthquake <- read.table(file = "earthquake.txt", header = TRUE, sep = "", dec = ".")
data <- read.table(file = "earthquake.txt", header = TRUE, sep = "", dec = ".")

ggplot(earthquake, aes(x=body, y=surface, color=type)) +
  geom_point(size=1, alpha=0.8, shape=19) + theme_light(base_size = 12) +
  labs(title = "Body-wave Magnitude vs. Surface-wave Magnitude",subtitle = "Comparing earthquake types",
       x = "Body-wave Magnitude (mb)",
       y = "Surface-wave Magnitude (Ms)",
       color = "Type") +
  scale_color_brewer(palette = "Set1") +theme(legend.position = "right")

```

```{r}
library(ggplot2)

ggplot(data, aes(x = type, y = body, fill = type)) +
  geom_boxplot(alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "darkgray") +
  labs(title = "Box Plot with Jitter of Body-Wave Magnitude by Type",
       x = "Type",
       y = "Body-Wave Magnitude (mb)") +
  theme_minimal()

```

```{r}
library(ggplot2)

ggplot(data, aes(x = type, y = surface, fill = type)) +
  geom_boxplot(alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "darkgray") +
  labs(title = "Box Plot with Jitter of Surface-Wave Magnitude by Type",
       x = "Type",
       y = "Surface-Wave Magnitude (Ms)") +
  theme_minimal()

```


## ML part B

```{r part B(random forest), echo=FALSE}


data <- read.table(file = "earthquake.txt", header = TRUE, sep = "", dec = ".")

data$type <- as.factor(data$type)

set.seed(123) 
rf_model <- randomForest(type ~ body + surface, data=data)

plot_data <- with(data, expand.grid(body=seq(min(body), max(body), length.out=100),
                                    surface=seq(min(surface), max(surface), length.out=100)))
plot_data$type <- predict(rf_model, newdata=plot_data, type="class")

ggplot(data, aes(x=body, y=surface, color=type)) +
  geom_point() +
  geom_point(data=plot_data, aes(x=body, y=surface, color=type), alpha=0.5) +
  labs(title="Random Forest Decision Boundary with Data Points")

```




